<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Correct Color Picker</title>

  <!-- Bootstrap File -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">

  <!-- JQuery -->
  <script src="https://code.jquery.com/jquery.js"></script>

  <style>
    #rand-target-color,
    #color-picker li {
      font-size: 24px;
    }
  </style>

</head>
<body>

  <div class="container">
    <h2>Correct Color Picker</h2>
    <p>Pick the <b>color</b> of the word shown from the list below it.</p>

    <div class="card">
      <div class="card-header">
        <h3 class="card-title">

          <!-- Create random target color -->
          <span id="rand-target-color">
          </span>

        </h3>
      </div>
      <div class="card-body">

        <!-- Create colors to pick -->
        <ul class="list-unstyled" id="color-picker">
        </ul>

      </div>
    </div>
  </div>

  <script>

    // JavaScript function that wraps everything
    $(document).ready(function() 
    {
        var jediList = new Map();
        var playerJedi = null;
        var gameState = "";
        var curEnemy = null;
        var pickableJedi = new Map();
        function jedi(initName = "", initImage = "", initStartHp = 0, initAttack = 0, initCounterAtk = 0)
        {
            this.name = initName;
            this.image = initImage;
            this.startHp = initStartHp;
            this.hp = initStartHp;
            this.baseAtk = initAttack;
            this.currentAtk = initAttack;
            this.counterAtk = initCounterAtk;
            this.isDead = function()
            {
                if(this.hp <= 0)
                {
                    return true;
                }
                return false;
            };

            this.reInit = function()
            {
                this.hp = this.startHp;
                this.currentAtk = this.baseAtk;
            
            };

            this.attack = function()
            {
                var temp = tcurrent;
                this.currentAtk += this.baseAtk;
                return temp;
            };

            this.counter = function()
            {
                return this.counterAtk;
            };

            this.takeDmg = function(atk)
            {
                this.hp -= atk;
                return this.isDead();
            };
            
            return this;
        }


        function createJedi(name)
        {
            switch(name)
            {
                case "Obi-Wan Kenobi":
                    return new jedi("Obi-Wan Kenobi");
                    break;
                case "Luke Skywalker":
                    return new jedi("Luke Skywalker");
                    break;
                case "Darth Vader":
                    return new jedi("Darth Vader");
                    break;
                case "Emperor Palpatine":
                    return new jedi("Emperor Palpatine");
                    break;
                default:
                    return "Error jedi not found";
            }
        }
        

        function populatePickList(mapToPop)
        {
            mapToPop.set("Obi-Wan Kenobi", createJedi("Obi-Wan Kenobi"));
            mapToPop.set("Luke Skywalker", createJedi("Luke Skywalker"));
            mapToPop.set("Darth Vader", createJedi("Darth Vader"));
            mapToPop.set("Emperor Palpatine", createJedi("Emperor Palpatine"));
        }

        function pickJedi(jediPicked, mapIn)
        {
            var temp = mapIn.get(jediPicked);
            mapIn.delete(jediPicked);
            return temp;
        }

        function load()
        {
            populatePickList(jediList);
            gameState = "pickChar";
            draw();
        }

        function init()
        {
            for(let i of jediList)
            {
                pickableJedi.set(i[0], i[1]);
            }
            
        }
        
        function reset()
        {
            jediList.set(playerJedi.name, playerJedi);
            for(let i of jediList.values())
            {
                i.reInit();
            }

            playerJedi = null;
            init();
            gameState = "pickChar";
        }

        function draw()
        {

        }

        load();
        init();

        $("#pickJedi").click(function(event) 
        {
            if(gameState == "pickChar")
            {
                var jedi = $(event.target).attr("jediName");
                playerJedi = pickJedi(jedi, pickableJedi);
                gameState = "pickAttacker";
                draw();
            }
        });

        $("#pickEnemy").click(function(event) 
        {
            if(gameState == "pickAttacker")
            {
                var jedi = $(event.target).attr("jediName");
                curEnemy = pickJedi(jedi, pickableJedi);
                gameState = "Fight";
                draw();
            }
        });

        $("#fight").click(function(event) 
        {
            if(gameState == "fight")
            {
                if(curEnemy.takeDmg(playerJedi.attack()))
                {
                    if(pickableJedi.size == 0)
                    {
                        gameState = "win";
                    }
                    else
                    {
                        gameState = "pickAttacker";
                    }
                    
                }
                else if(playerJedi.takeDmg(curEnemy.counter()))
                {
                    gameState = "loss";
                }

                draw();
            }
        });


        $("#replay").click(function(event) 
        {
            reset();
            draw();
        });

        $("#pickEnemy").click(function(event) 
        {
            if(gameState == "pickAttacker")
            {
                var jedi = $(event.target).attr("jediName");
                curEnemy = pickJedi(jedi, pickableJedi);
                gameState = "Fight";
                draw();
            }
        });

        //reset();
    });

  </script>
</body>
</html>
